{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport jwtDecode from \"jwt-decode\";\nexport const registerUser = createAsyncThunk(\"auth/registerUser\", async (user, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n\n  try {\n    const token = await axios.post(\"http://localhost:5000/api/register\", {\n      username: user.username,\n      email: user.email,\n      password: user.password\n    });\n    localStorage.setItem(\"token\", token.data);\n    return token.data;\n  } catch (err) {\n    console.log(err.response.data);\n    return rejectWithValue(err.response.data);\n  }\n});\nexport const loginUser = createAsyncThunk(\"auth/loginUser\", async (user, _ref2) => {\n  let {\n    rejectWithValue\n  } = _ref2;\n\n  try {\n    const token = await axios.post(\"http://localhost:5000/api/login\", user);\n    localStorage.setItem(\"token\", token.data);\n    return token.data;\n  } catch (err) {\n    console.log(err.response.data);\n    return rejectWithValue(err.response.data);\n  }\n});\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    token: localStorage.getItem(\"token\"),\n    username: \"\",\n    email: \"\",\n    _id: \"\",\n    registerStatus: \"\",\n    registerError: \"\",\n    loginStatus: \"\",\n    loginError: \"\",\n    userLoaded: false\n  },\n  reducers: {\n    loadUser: state => {\n      const token = state.token;\n\n      if (token) {\n        const user = jwtDecode(token);\n        state.token = token;\n        state.username = user.username;\n        state._id = user._id;\n        state.userLoaded = true;\n        state.loginStatus = \"Success\";\n      }\n    },\n    logOutUser: state => {\n      localStorage.removeItem(\"token\");\n      state.token = \"\";\n      state.username = \"\";\n      state.email = \"\";\n      state._id = \"\";\n      state.registerStatus = \"\";\n      state.registerError = \"\";\n      state.loginStatus = \"\";\n      state.loginError = \"\";\n    }\n  },\n  extraReducers: {\n    [registerUser.pending]: state => {\n      state.registerStatus = \"Pending\";\n    },\n    [registerUser.fulfilled]: (state, _ref3) => {\n      let {\n        payload\n      } = _ref3;\n      const user = jwtDecode(payload);\n      state.token = payload;\n      state.username = user.username;\n      state.email = user.email;\n      state._id = user._id;\n      state.registerStatus = \"Success\";\n    },\n    [registerUser.rejected]: (state, _ref4) => {\n      let {\n        payload\n      } = _ref4;\n      state.registerStatus = \"Rejected\";\n      state.registerError = payload;\n    },\n    [loginUser.pending]: state => {\n      state.loginStatus = \"Pending\";\n    },\n    [loginUser.fulfilled]: (state, _ref5) => {\n      let {\n        payload\n      } = _ref5;\n      const user = jwtDecode(payload);\n      state.token = payload;\n      state.username = user.username;\n      state._id = user._id;\n      state.loginStatus = \"Success\";\n    },\n    [loginUser.rejected]: (state, _ref6) => {\n      let {\n        payload\n      } = _ref6;\n      state.loginStatus = \"Rejected\";\n      state.loginError = payload;\n    }\n  }\n});\nexport const {\n  loadUser,\n  logOutUser\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","jwtDecode","registerUser","user","rejectWithValue","token","post","username","email","password","localStorage","setItem","data","err","console","log","response","loginUser","authSlice","name","initialState","getItem","_id","registerStatus","registerError","loginStatus","loginError","userLoaded","reducers","loadUser","state","logOutUser","removeItem","extraReducers","pending","fulfilled","payload","rejected","actions","reducer"],"sources":["C:/Users/PC'S/Desktop/Nouveau dossier/ecommerce mahdi/client/src/redux/features/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\nimport jwtDecode from \"jwt-decode\";\r\n\r\nexport const registerUser = createAsyncThunk(\r\n  \"auth/registerUser\",\r\n  async (user, { rejectWithValue }) => {\r\n    try {\r\n      const token = await axios.post(\"http://localhost:5000/api/register\", {\r\n        username: user.username,\r\n        email: user.email,\r\n        password: user.password,\r\n      });\r\n      localStorage.setItem(\"token\", token.data);\r\n      return token.data;\r\n    } catch (err) {\r\n      console.log(err.response.data);\r\n      return rejectWithValue(err.response.data);\r\n    }\r\n  }\r\n);\r\nexport const loginUser = createAsyncThunk(\r\n  \"auth/loginUser\",\r\n  async (user, { rejectWithValue }) => {\r\n    try {\r\n      const token = await axios.post(\"http://localhost:5000/api/login\", user);\r\n      localStorage.setItem(\"token\", token.data);\r\n      return token.data;\r\n    } catch (err) {\r\n      console.log(err.response.data);\r\n      return rejectWithValue(err.response.data);\r\n    }\r\n  }\r\n);\r\nconst authSlice = createSlice({\r\n  name: \"auth\",\r\n  initialState: {\r\n    token: localStorage.getItem(\"token\"),\r\n    username: \"\",\r\n    email: \"\",\r\n    _id: \"\",\r\n    registerStatus: \"\",\r\n    registerError: \"\",\r\n    loginStatus: \"\",\r\n    loginError: \"\",\r\n    userLoaded: false,\r\n  },\r\n  reducers: {\r\n    loadUser: (state) => {\r\n      const token = state.token;\r\n      if (token) {\r\n        const user = jwtDecode(token);\r\n        state.token = token;\r\n        state.username = user.username;\r\n        state._id = user._id;\r\n        state.userLoaded = true;\r\n        state.loginStatus = \"Success\";\r\n      }\r\n    },\r\n    logOutUser: (state) => {\r\n      localStorage.removeItem(\"token\");\r\n      state.token = \"\";\r\n      state.username = \"\";\r\n      state.email = \"\";\r\n      state._id = \"\";\r\n      state.registerStatus = \"\";\r\n      state.registerError = \"\";\r\n      state.loginStatus = \"\";\r\n      state.loginError = \"\";\r\n    },\r\n  },\r\n  extraReducers: {\r\n    [registerUser.pending]: (state) => {\r\n      state.registerStatus = \"Pending\";\r\n    },\r\n    [registerUser.fulfilled]: (state, { payload }) => {\r\n      const user = jwtDecode(payload);\r\n      state.token = payload;\r\n      state.username = user.username;\r\n      state.email = user.email;\r\n      state._id = user._id;\r\n      state.registerStatus = \"Success\";\r\n    },\r\n    [registerUser.rejected]: (state, { payload }) => {\r\n      state.registerStatus = \"Rejected\";\r\n      state.registerError = payload;\r\n    },\r\n    [loginUser.pending]: (state) => {\r\n      state.loginStatus = \"Pending\";\r\n    },\r\n    [loginUser.fulfilled]: (state, { payload }) => {\r\n      const user = jwtDecode(payload);\r\n      state.token = payload;\r\n      state.username = user.username;\r\n      state._id = user._id;\r\n      state.loginStatus = \"Success\";\r\n    },\r\n    [loginUser.rejected]: (state, { payload }) => {\r\n      state.loginStatus = \"Rejected\";\r\n      state.loginError = payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { loadUser, logOutUser } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}